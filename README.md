# Wheel 마이크로서비스 보일러플레이트 스터디

## utils 폴더 구조

`utils` 폴더는 웹 스크래핑 기능을 제공하는 모듈식 서비스를 포함하고 있으며, 특히 사람인 구직 정보를 수집하는 데 특화되어 있습니다. 이 아키텍처는 의존성 주입과 서비스 구성을 위해 팩토리 패턴을 따릅니다.

### 핵심 컴포넌트

#### 팩토리 서비스
- **ScraperFactory.ts**: 팩토리 패턴을 구현하여 모든 유틸리티 서비스를 생성하고 관리합니다. 서비스 간 의존성 주입을 처리하고 싱글톤 인스턴스를 유지합니다.

#### 컨트롤 서비스
- **ScraperControlService.ts**: 스크래핑 워크플로우를 조율합니다. 모든 유틸리티 서비스에 대한 파사드 역할을 하며, 메인 애플리케이션에 간소화된 인터페이스를 제공합니다.

### 전문 서비스

#### 브라우저 자동화
- **browser/BrowserService.ts**: Puppeteer 브라우저 인스턴스를 관리합니다. 브라우저 초기화, 페이지 생성, 재시도 로직이 포함된 탐색 및 페이지 평가를 처리합니다.

#### 웹 스크래핑
- **scraper/SaraminScraper.ts**: 사람인 구직 사이트 전용 스크래퍼입니다. 채용 공고를 추출하고, 직무 세부 정보를 처리하며, 페이지네이션과 중복 감지를 처리합니다.

#### 이미지 처리
- **image/ImageProcessor.ts**: OCR 처리를 위한 이미지 크기 조정, 형식 변환, 스크린샷 캡처와 같은 이미지 관련 작업을 처리합니다.

#### OCR (광학 문자 인식)
- **ocr/OcrService.ts**: Mistral AI의 OCR 기능을 사용하여 이미지에서 텍스트를 추출합니다. 또한 추출된 콘텐츠의 텍스트 정리 및 개선을 처리합니다.

#### 로깅
- **logging/LoggerService.ts**: 다양한 로그 레벨과 상세도 제어 기능으로 모든 서비스에 일관된 로깅을 제공합니다.

#### 데이터 저장
- **db/JobRepository.ts**: 채용 데이터의 지속성, 검색 및 통계 생성을 관리합니다.

### 데이터 타입
- **types/JobTypes.ts**: 유틸리티 서비스 전반에 걸쳐 사용되는 TypeScript 인터페이스와 타입을 포함합니다.

## 아키텍처 개요

서비스는 명확한 관심사 분리를 갖춘 모듈식 설계를 따릅니다:

1. **팩토리 패턴**: ScraperFactory는 모든 서비스 인스턴스를 생성하고 관리하여 적절한 의존성 주입을 보장합니다.
2. **파사드 패턴**: ScraperControlService는 복잡한 스크래퍼 유틸리티 하위 시스템에 대한 간소화된 인터페이스를 제공합니다.
3. **리포지토리 패턴**: JobRepository는 데이터 저장 작업을 추상화합니다.
4. **서비스 레이어**: 각 전문 서비스는 관련 기능을 캡슐화합니다.

## 서비스 흐름

1. 메인 애플리케이션이 ScraperControlService를 호출합니다
2. ScraperControlService는 ScraperFactory로부터 서비스 인스턴스를 가져옵니다
3. BrowserService가 브라우저 인스턴스를 초기화합니다
4. SaraminScraper가 채용 목록 페이지를 처리합니다
5. 각 채용 공고마다:
   - 가능한 경우 직접 텍스트가 추출됩니다
   - 필요할 때 이미지는 ImageProcessor에 의해 처리됩니다
   - OCR 서비스가 이미지에서 텍스트를 추출합니다
   - JobRepository가 추출된 채용 정보를 저장합니다

## 유틸리티 기능

- **오류 처리**: 네트워크 요청 및 API 호출에 대한 포괄적인 재시도 메커니즘
- **속도 제한**: API 속도 제한에 대한 지수 백오프
- **중복 감지**: 중복 채용 공고 방지
- **점진적 성능 저하**: 기본 추출 방법이 실패할 때의 대체 전략
